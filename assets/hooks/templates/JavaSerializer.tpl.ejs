// WANING: Do not edit this file. All changes will be lost.

package io.github.airamrguez.plugins.realm;

import io.realm.RealmList;

import com.google.gson.Gson;
import com.google.gson.GsonBuilder;
import com.google.gson.JsonElement;
import com.google.gson.JsonObject;
import com.google.gson.JsonSerializationContext;
import com.google.gson.JsonSerializer;

import java.lang.reflect.Type;
import java.util.Date;

<%
var className = capitalize(schema.name);
-%>

public class <%- className %>Serializer implements JsonSerializer<<%- className %>> {
    @Override
    public JsonElement serialize(<%- className %> src, Type typeOfSrc, JsonSerializationContext context) {
        final JsonObject json = new JsonObject();
        Object field;
    <%
    var properties = schema.properties;
    Object.keys(properties).forEach(function(propName) {
      var propValue = properties[propName];
      var propType = javaType(propValue);
      var capitalizedPropName = capitalize(propName);
      var propGetter = 'get' + capitalizedPropName + '()';
      if (isPropertyList(propValue)) {
        var capitalizedPropType = capitalize(propValue.objectType);
    -%>
        json.add("<%- propName %>", context.serialize(src.<%- propGetter %>.toArray(), <%- capitalizedPropType %>[].class));
    <%
      } else if (isSchemaProperty(propType)) {
    -%>
        json.add("<%- propName %>", context.serialize(src.<%- propGetter %>));
    <%
      } else if (isPropertyNullable(propValue)) {
    -%>
        field = src.<%- propGetter %>;
        boolean is<%- capitalizedPropName %>Null = field != null;
    <%
        if (propType === 'String' || propType === 'Date') {
    -%>
        json.addProperty("<%- propName %>", is<%- capitalizedPropName %>Null ? null : ((<%- propType %>)field).toString());
    <%
        } else {
    -%>
        json.addProperty("<%- propName %>", field);
    <%
        }
      } else {
        if (propType === 'Date') {
    -%>
        json.addProperty("<%- propName %>", src.<%- propGetter %>.toString());
    <%
        } else {
    -%>
        json.addProperty("<%- propName %>", src.<%- propGetter %>);
    <%
        }
      }
    });
    -%>
      return json;
    }
}
